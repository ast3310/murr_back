##
# fail2ban helper https://easyengine.io/tutorials/nginx/fail2ban/
##
# in /etc/nginx/nginx.conf
#    add limit_req_zone $binary_remote_addr zone=one:10m rate=1r/s;
##

server {

    listen 80;
    server_name murrengan.ru;

    location / {
      root   /home/murrengan/murr_front/dist;
      index  index.html;
      try_files $uri $uri/ /index.html;
    }


    location /admin/ {

        include proxy_params;
        proxy_pass http://unix:/home/murrengan/murr_back/murr_nginx_gunicorn_layer.sock;
    }

    location /static/  {

        alias /home/murrengan/murr_back/staticfiles/;
    }

    location /murren/ {

        include proxy_params;
        limit_req   zone=one  burst=1 nodelay;
        proxy_pass http://unix:/home/murrengan/murr_back/murr_nginx_gunicorn_layer.sock;
    }

    location /media/ {

        alias /home/murrengan/murr_back/media/;
    }

    location /orig/ {
        proxy_pass https://api.telegram.org/;
    }

}
